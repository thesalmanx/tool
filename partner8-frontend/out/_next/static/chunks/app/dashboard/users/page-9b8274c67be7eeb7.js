(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{2714:(e,s,a)=>{"use strict";a.d(s,{J:()=>o});var t=a(5155),r=a(2115),l=a(968),n=a(2085),i=a(3999);let d=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(l.b,{ref:s,className:(0,i.cn)(d(),a),...r})});o.displayName=l.b.displayName},3948:(e,s,a)=>{"use strict";a.r(s),a.d(s,{default:()=>M});var t=a(5155),r=a(2115),l=a(5695),n=a(6643),i=a(8482),d=a(7168),o=a(9852),c=a(2714),u=a(1461),m=a(6474),h=a(7863),p=a(5196),x=a(3999);let f=u.bL;u.YJ;let j=u.WT,g=r.forwardRef((e,s)=>{let{className:a,children:r,...l}=e;return(0,t.jsxs)(u.l9,{ref:s,className:(0,x.cn)("flex h-9 w-full items-center justify-between whitespace-nowrap rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",a),...l,children:[r,(0,t.jsx)(u.In,{asChild:!0,children:(0,t.jsx)(m.A,{className:"h-4 w-4 opacity-50"})})]})});g.displayName=u.l9.displayName;let y=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(u.PP,{ref:s,className:(0,x.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(h.A,{className:"h-4 w-4"})})});y.displayName=u.PP.displayName;let N=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(u.wn,{ref:s,className:(0,x.cn)("flex cursor-default items-center justify-center py-1",a),...r,children:(0,t.jsx)(m.A,{className:"h-4 w-4"})})});N.displayName=u.wn.displayName;let v=r.forwardRef((e,s)=>{let{className:a,children:r,position:l="popper",...n}=e;return(0,t.jsx)(u.ZL,{children:(0,t.jsxs)(u.UC,{ref:s,className:(0,x.cn)("relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]","popper"===l&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",a),position:l,...n,children:[(0,t.jsx)(y,{}),(0,t.jsx)(u.LM,{className:(0,x.cn)("p-1","popper"===l&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:r}),(0,t.jsx)(N,{})]})})});v.displayName=u.UC.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(u.JU,{ref:s,className:(0,x.cn)("px-2 py-1.5 text-sm font-semibold",a),...r})}).displayName=u.JU.displayName;let w=r.forwardRef((e,s)=>{let{className:a,children:r,...l}=e;return(0,t.jsxs)(u.q7,{ref:s,className:(0,x.cn)("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a),...l,children:[(0,t.jsx)("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,t.jsx)(u.VF,{children:(0,t.jsx)(p.A,{className:"h-4 w-4"})})}),(0,t.jsx)(u.p4,{children:r})]})});w.displayName=u.q7.displayName,r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(u.wv,{ref:s,className:(0,x.cn)("-mx-1 my-1 h-px bg-muted",a),...r})}).displayName=u.wv.displayName;var b=a(8145),A=a(9026),C=a(5452),_=a(4416);let k=C.bL,R=C.l9,U=C.ZL;C.bm;let T=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(C.hJ,{ref:s,className:(0,x.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",a),...r})});T.displayName=C.hJ.displayName;let F=r.forwardRef((e,s)=>{let{className:a,children:r,...l}=e;return(0,t.jsxs)(U,{children:[(0,t.jsx)(T,{}),(0,t.jsxs)(C.UC,{ref:s,className:(0,x.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",a),...l,children:[r,(0,t.jsxs)(C.bm,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,t.jsx)(_.A,{className:"h-4 w-4"}),(0,t.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});F.displayName=C.UC.displayName;let E=e=>{let{className:s,...a}=e;return(0,t.jsx)("div",{className:(0,x.cn)("flex flex-col space-y-1.5 text-center sm:text-left",s),...a})};E.displayName="DialogHeader";let z=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(C.hE,{ref:s,className:(0,x.cn)("text-lg font-semibold leading-none tracking-tight",a),...r})});z.displayName=C.hE.displayName;let J=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)(C.VY,{ref:s,className:(0,x.cn)("text-sm text-muted-foreground",a),...r})});J.displayName=C.VY.displayName;var P=a(8524),S=a(4616),L=a(2318),q=a(7951),B=a(646),$=a(3717),I=a(4938);let O=e=>{var s;let a="; ".concat(document.cookie).split("; ".concat(e,"="));return 2===a.length&&(null==(s=a.pop())?void 0:s.split(";").shift())||null},H=e=>{document.cookie="".concat(e,"=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;")};function M(){let[e,s]=(0,r.useState)([]),[a,u]=(0,r.useState)(1),[m,h]=(0,r.useState)(1),[p,x]=(0,r.useState)(!0),[y,N]=(0,r.useState)(""),[C,_]=(0,r.useState)(""),[U,T]=(0,r.useState)(!1),[M,D]=(0,r.useState)(null),[V,Z]=(0,r.useState)({username:"",email:"",password:"",role:"user",is_approved:!0}),Y=(0,l.useRouter)();(0,r.useEffect)(()=>{(async()=>{let e=O("access_token"),s=O("user_role");return e?"admin"!==s?Y.push("/dashboard"):await X():Y.push("/")})()},[Y]);let W=()=>{H("access_token"),H("username"),H("user_role"),H("user_id"),H("user_email")},X=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:a;try{let a=O("access_token");if(!a){W(),Y.push("/");return}let t=await I.u.get("/users?page=".concat(e,"&limit=").concat(10),{headers:{Authorization:"Bearer ".concat(a)}});s(t.users),h(Math.ceil(t.total/10)),u(t.page)}catch(e){console.error("Failed to fetch users:",e),e.message&&e.message.includes("401")&&(W(),Y.push("/")),N(e.message||"Failed to fetch users")}finally{x(!1)}},G=async e=>{try{let s=O("access_token");if(!s){W(),Y.push("/");return}await I.u.put("/approve_user/".concat(e),null,{Authorization:"Bearer ".concat(s)}),_("User approved successfully"),X(),setTimeout(()=>_(""),3e3)}catch(e){console.error("Failed to approve user:",e),e.message&&e.message.includes("401")?(W(),Y.push("/")):N(e.message||"Failed to approve user")}},K=async e=>{try{let s=O("access_token");if(!s){W(),Y.push("/");return}await I.u.put("/promote_to_admin/".concat(e),null,{Authorization:"Bearer ".concat(s)}),_("User promoted to admin successfully"),X(),setTimeout(()=>_(""),3e3)}catch(e){console.error("Failed to promote user:",e),e.message&&e.message.includes("401")?(W(),Y.push("/")):N(e.message||"Failed to promote user")}},Q=async(e,s)=>{try{let a=O("access_token");if(!a){W(),Y.push("/");return}await I.u.put("/users/".concat(e),s,{Authorization:"Bearer ".concat(a)}),_("User updated successfully"),X(),D(null),setTimeout(()=>_(""),3e3)}catch(e){console.error("Failed to update user:",e),e.message&&e.message.includes("401")?(W(),Y.push("/")):N(e.message||"Failed to update user")}},ee=async e=>{e.preventDefault();try{let e=O("access_token");if(!e){W(),Y.push("/");return}await I.u.post("/users",V,{Authorization:"Bearer ".concat(e)}),_("User created successfully"),T(!1),Z({username:"",email:"",password:"",role:"user",is_approved:!0}),X(),setTimeout(()=>_(""),3e3)}catch(e){console.error("Failed to create user:",e),e.message&&e.message.includes("401")?(W(),Y.push("/")):N(e.message||"Failed to create user")}};return p?(0,t.jsx)(n.A,{children:(0,t.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),(0,t.jsx)("p",{className:"mt-4 text-gray-600",children:"Loading users..."})]})})}):(0,t.jsx)(n.A,{children:(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h1",{className:"text-3xl font-bold",children:"User Management"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Manage users, roles, and permissions"})]}),(0,t.jsxs)(k,{open:U,onOpenChange:T,children:[(0,t.jsx)(R,{asChild:!0,children:(0,t.jsxs)(d.$,{children:[(0,t.jsx)(S.A,{className:"h-4 w-4 mr-2"}),"Create User"]})}),(0,t.jsxs)(F,{children:[(0,t.jsxs)(E,{children:[(0,t.jsx)(z,{children:"Create New User"}),(0,t.jsx)(J,{children:"Add a new user to the system with specified role and permissions."})]}),(0,t.jsxs)("form",{onSubmit:ee,className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"username",children:"Username"}),(0,t.jsx)(o.p,{id:"username",value:V.username,onChange:e=>Z({...V,username:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"email",children:"Email"}),(0,t.jsx)(o.p,{id:"email",type:"email",value:V.email,onChange:e=>Z({...V,email:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"password",children:"Password"}),(0,t.jsx)(o.p,{id:"password",type:"password",value:V.password,onChange:e=>Z({...V,password:e.target.value}),required:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{htmlFor:"role",children:"Role"}),(0,t.jsxs)(f,{value:V.role,onValueChange:e=>Z({...V,role:e}),children:[(0,t.jsx)(g,{children:(0,t.jsx)(j,{})}),(0,t.jsxs)(v,{children:[(0,t.jsx)(w,{value:"user",children:"User"}),(0,t.jsx)(w,{value:"admin",children:"Admin"})]})]})]}),(0,t.jsxs)(d.$,{type:"submit",className:"w-full",children:[(0,t.jsx)(L.A,{className:"h-4 w-4 mr-2"}),"Create User"]})]})]})]})]}),y&&(0,t.jsx)(A.Fc,{variant:"destructive",children:(0,t.jsx)(A.TN,{children:y})}),C&&(0,t.jsx)(A.Fc,{children:(0,t.jsx)(A.TN,{children:C})}),(0,t.jsxs)(i.Zp,{children:[(0,t.jsxs)(i.aR,{children:[(0,t.jsx)(i.ZB,{children:"All Users"}),(0,t.jsx)(i.BT,{children:"Manage user accounts, roles, and approval status"})]}),(0,t.jsxs)(i.Wu,{children:[(0,t.jsxs)(P.XI,{children:[(0,t.jsx)(P.A0,{children:(0,t.jsxs)(P.Hj,{children:[(0,t.jsx)(P.nd,{children:"Username"}),(0,t.jsx)(P.nd,{children:"Email"}),(0,t.jsx)(P.nd,{children:"Role"}),(0,t.jsx)(P.nd,{children:"Status"}),(0,t.jsx)(P.nd,{children:"Created"}),(0,t.jsx)(P.nd,{children:"Actions"})]})}),(0,t.jsx)(P.BF,{children:e.map(e=>(0,t.jsxs)(P.Hj,{children:[(0,t.jsx)(P.nA,{className:"font-medium",children:e.username}),(0,t.jsx)(P.nA,{children:e.email}),(0,t.jsx)(P.nA,{children:(0,t.jsxs)(b.E,{variant:"admin"===e.role?"default":"secondary",children:["admin"===e.role&&(0,t.jsx)(q.A,{className:"h-3 w-3 mr-1"}),e.role]})}),(0,t.jsx)(P.nA,{children:(0,t.jsx)(b.E,{variant:e.is_approved?"default":"destructive",children:e.is_approved?"Approved":"Pending"})}),(0,t.jsx)(P.nA,{children:new Date(e.created_at).toLocaleDateString()}),(0,t.jsx)(P.nA,{children:(0,t.jsxs)("div",{className:"flex space-x-2",children:[!e.is_approved&&(0,t.jsxs)(d.$,{size:"sm",onClick:()=>G(e.id),children:[(0,t.jsx)(B.A,{className:"h-4 w-4 mr-1"}),"Approve"]}),"admin"!==e.role&&e.is_approved&&(0,t.jsxs)(d.$,{size:"sm",variant:"outline",onClick:()=>K(e.id),children:[(0,t.jsx)(q.A,{className:"h-4 w-4 mr-1"}),"Promote"]}),(0,t.jsxs)(d.$,{size:"sm",variant:"outline",onClick:()=>D(e),children:[(0,t.jsx)($.A,{className:"h-4 w-4 mr-1"}),"Edit"]})]})})]},e.id))})]}),(0,t.jsxs)("div",{className:"flex justify-between items-center mt-4",children:[(0,t.jsx)(d.$,{onClick:()=>X(a-1),disabled:1===a||p,variant:"outline",size:"sm",children:"Previous"}),(0,t.jsxs)("span",{className:"text-sm text-gray-600",children:["Page ",a," of ",m]}),(0,t.jsx)(d.$,{onClick:()=>X(a+1),disabled:a===m||p,variant:"outline",size:"sm",children:"Next"})]})]})]}),(0,t.jsx)(k,{open:!!M,onOpenChange:()=>D(null),children:(0,t.jsxs)(F,{children:[(0,t.jsxs)(E,{children:[(0,t.jsx)(z,{children:"Edit User"}),(0,t.jsx)(J,{children:"Update user role and approval status."})]}),M&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{children:"Username"}),(0,t.jsx)(o.p,{value:M.username,disabled:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{children:"Email"}),(0,t.jsx)(o.p,{value:M.email,disabled:!0})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)(c.J,{children:"Role"}),(0,t.jsxs)(f,{value:M.role,onValueChange:e=>D({...M,role:e}),children:[(0,t.jsx)(g,{children:(0,t.jsx)(j,{})}),(0,t.jsxs)(v,{children:[(0,t.jsx)(w,{value:"user",children:"User"}),(0,t.jsx)(w,{value:"admin",children:"Admin"})]})]})]}),(0,t.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,t.jsx)("input",{type:"checkbox",id:"approved",checked:M.is_approved,onChange:e=>D({...M,is_approved:e.target.checked})}),(0,t.jsx)(c.J,{htmlFor:"approved",children:"Approved"})]}),(0,t.jsx)(d.$,{onClick:()=>Q(M.id,{role:M.role,is_approved:M.is_approved}),className:"w-full",children:"Update User"})]})]})})]})})}},4021:(e,s,a)=>{Promise.resolve().then(a.bind(a,3948))},4938:(e,s,a)=>{"use strict";a.d(s,{u:()=>r});class t{async request(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,t=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l="".concat(this.baseURL).concat(s),n={method:e,headers:{"Content-Type":"application/json",...t}};a&&(n.body=JSON.stringify(a));let i="".concat(e,"-").concat(l,"-").concat(JSON.stringify(a));if(r&&this.cache.has(i))return console.log("Cache hit for ".concat(i)),this.cache.get(i);try{let e=await fetch(l,n);if(!e.ok){let s=await e.json().catch(()=>({detail:e.statusText}));throw Error(s.detail||"API Error: ".concat(e.status))}let s=await e.json();return r&&this.cache.set(i,s),s}catch(s){throw console.error("API Request Error (".concat(e," ").concat(l,"):"),s),s}}get(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.request("GET",e,null,s,a)}post(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("POST",e,s,a)}put(e,s){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return this.request("PUT",e,s,a)}delete(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.request("DELETE",e,null,s)}constructor(){this.baseURL=function(){let e=window.location.hostname;window.location.port;let s=window.location.protocol;return"localhost"===e||"127.0.0.1"===e?"http://localhost:8000":"".concat(s,"//").concat(e,":8000")}(),this.cache=new Map,console.log("API Client initialized with base URL: ".concat(this.baseURL))}}let r=new t},8524:(e,s,a)=>{"use strict";a.d(s,{A0:()=>i,BF:()=>d,Hj:()=>o,XI:()=>n,nA:()=>u,nd:()=>c});var t=a(5155),r=a(2115),l=a(3999);let n=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("div",{className:"relative w-full overflow-auto",children:(0,t.jsx)("table",{ref:s,className:(0,l.cn)("w-full caption-bottom text-sm",a),...r})})});n.displayName="Table";let i=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("thead",{ref:s,className:(0,l.cn)("[&_tr]:border-b",a),...r})});i.displayName="TableHeader";let d=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tbody",{ref:s,className:(0,l.cn)("[&_tr:last-child]:border-0",a),...r})});d.displayName="TableBody",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tfoot",{ref:s,className:(0,l.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",a),...r})}).displayName="TableFooter";let o=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("tr",{ref:s,className:(0,l.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",a),...r})});o.displayName="TableRow";let c=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("th",{ref:s,className:(0,l.cn)("h-10 px-2 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...r})});c.displayName="TableHead";let u=r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("td",{ref:s,className:(0,l.cn)("p-2 align-middle [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",a),...r})});u.displayName="TableCell",r.forwardRef((e,s)=>{let{className:a,...r}=e;return(0,t.jsx)("caption",{ref:s,className:(0,l.cn)("mt-4 text-sm text-muted-foreground",a),...r})}).displayName="TableCaption"},9852:(e,s,a)=>{"use strict";a.d(s,{p:()=>n});var t=a(5155),r=a(2115),l=a(3999);let n=r.forwardRef((e,s)=>{let{className:a,type:r,...n}=e;return(0,t.jsx)("input",{type:r,className:(0,l.cn)("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",a),ref:s,...n})});n.displayName="Input"}},e=>{e.O(0,[711,758,539,468,321,441,964,358],()=>e(e.s=4021)),_N_E=e.O()}]);